{
  "schemaVersion": "1.0",
  "version": "1",
  "id": "rsi",
  "label": "RSI",
  "category": "Momentum",
  "tier": "CORE",
  "tags": ["Momentum", "Oscillator"],

  "blurb": "Momentum oscillator scaled 0–100; useful for momentum filters, pullback continuations, and mean-reversion bounces.",
  "longSummary": "The Relative Strength Index (RSI) compares the magnitude of recent gains to losses over a configurable length and outputs a 0–100 value. Momentum traders often require RSI to reclaim a threshold (e.g., 55–60) after a quiet phase; pullback traders look for dips into 40–50 that turn back up; mean-reversion entries watch for rebounds from oversold. RSI is more reliable when aligned with a broader trend filter (e.g., EMA 200) and when avoiding high-volatility news spikes.",
  "mathSummary": "RSI = 100 − 100 / (1 + RS), where RS = AvgGain / AvgLoss (smoothed).",
  "references": [
    "https://www.investopedia.com/terms/r/rsi.asp"
  ],

  "params": {
    "length":  { "type": "int",  "default": 14, "min": 2,  "max": 200, "step": 1, "unit": "bars" },
    "source":  { "type": "enum", "default": "close", "options": ["close", "open", "high", "low"] },
    "obLevel": { "type": "int",  "default": 70, "min": 50, "max": 100, "step": 1 },
    "osLevel": { "type": "int",  "default": 30, "min": 0,  "max": 50,  "step": 1 }
  },

  "outputs": ["value"],

  "supportedOperators": [
    ">", ">=", "<", "<=", "==",
    "crosses_above", "crosses_below",
    "rising", "falling",
    "within", "outside"
  ],

  "signals": {
    "bullish": [
      { "name": "RSI crosses above threshold", "left": "rsi.value", "op": "crosses_above", "rightParam": "obLevel" }
    ],
    "bearish": [
      { "name": "RSI crosses below threshold", "left": "rsi.value", "op": "crosses_below", "rightParam": "osLevel" }
    ]
  },

  "ui": {
    "tooltips": {
      "_indicator": "RSI measures momentum on a 0–100 scale.",
      "length": "Higher = smoother but slower.",
      "source": "Price field used to compute RSI.",
      "obLevel": "Momentum/overbought threshold; filters often use 55–60.",
      "osLevel": "Oversold threshold; bearish filters often use 40–45."
    },
    "badges": ["Momentum"]
  },

  "constraints": {
    "recommendedTimeframes": ["15m", "1h", "4h"]
  },

  "examples": [
    { "name": "RSI Trend Pop", "presetRef": "rsi_trend_pop" },
    { "name": "RSI Mean-Reversion Bounce", "presetRef": "rsi_mean_reversion_bounce" },
    { "name": "RSI Pullback Continuation", "presetRef": "rsi_pullback_continuation" },
    { "name": "RSI Momentum Stack", "presetRef": "rsi_momentum_stack" }
  ],

  "riskTemplates": {
    "atrStop": {
      "enabledDefault": false,
      "params": { "atrLength": 14, "mult": 2.0 },
      "tooltip": "ATR-scaled protective stop; widens in high volatility and tightens when quiet."
    },
    "trailingTP": {
      "enabledDefault": false,
      "params": { "trailPct": 0.7, "activationR": 1.0 },
      "tooltip": "Trailing take-profit to lock gains once the trade moves in your favor."
    },
    "breakeven": {
      "enabledDefault": false,
      "params": { "activationR": 1.0 },
      "tooltip": "Move stop to entry after reaching the activation R multiple."
    },
    "timeStop": {
      "enabledDefault": false,
      "params": { "bars": 30 },
      "tooltip": "Exit after a maximum number of bars if neither SL nor TP is hit."
    }
  },

  "presets": [
    {
      "id": "rsi_trend_pop",
      "label": "RSI Trend Pop",
      "blurb": "Momentum kick after a quiet patch, in an uptrend.",
      "indicators": ["rsi", "ema"],
      "seedParams": {
        "rsi": { "length": 14 },
        "ema": { "period": 200 }
      },
      "rules": {
        "joiner": "AND",
        "rules": [
          { "left": "rsi.value", "op": "<", "right": 55, "lookback": 10, "mode": "consecutive" },
          { "left": "rsi.value", "op": "crosses_above", "right": 55 },
          { "left": "close", "op": ">", "right": "ema.value", "optional": true }
        ]
      },
      "riskDefaults": {
        "atrStop":     { "params": { "atrLength": 14, "mult": 2.0 } },
        "trailingTP":  { "params": { "trailPct": 0.6, "activationR": 1.0 } },
        "breakeven":   { "params": { "activationR": 1.0 } }
      },
      "badges": ["Momentum", "Trend Filter"]
    },
    {
      "id": "rsi_mean_reversion_bounce",
      "label": "RSI Mean-Reversion Bounce",
      "blurb": "Rebound out of oversold for a quick snap-back.",
      "indicators": ["rsi", "sma"],
      "seedParams": {
        "rsi": { "length": 14 },
        "sma": { "period": 20 }
      },
      "rules": {
        "joiner": "AND",
        "rules": [
          { "left": "rsi.value", "op": "<", "right": 32, "lookback": 3 },
          { "left": "rsi.value", "op": "crosses_above", "right": 32 },
          { "left": "close", "op": "<", "right": "sma.value", "optional": true }
        ]
      },
      "riskDefaults": {
        "atrStop":     { "params": { "atrLength": 14, "mult": 1.8 } },
        "trailingTP":  { "params": { "trailPct": 0.6, "activationR": 1.0 } },
        "breakeven":   { "params": { "activationR": 1.0 } },
        "timeStop":    { "params": { "bars": 25 } }
      },
      "badges": ["Mean Reversion"]
    },
    {
      "id": "rsi_pullback_continuation",
      "label": "RSI Pullback Continuation",
      "blurb": "Buy the dip in an uptrend when RSI turns back up.",
      "indicators": ["rsi", "ema", "atr"],
      "seedParams": {
        "rsi": { "length": 14 },
        "ema": { "period": 200 },
        "atr": { "length": 14 }
      },
      "rules": {
        "joiner": "AND",
        "rules": [
          { "left": "close", "op": ">", "right": "ema.value" },
          { "left": "rsi.value", "op": "within", "right": [40, 50], "lookback": 5 },
          { "left": "rsi.value", "op": "crosses_above", "right": 50 },
          { "left": "atr.value", "op": ">", "right": 0, "optional": true }
        ]
      },
      "riskDefaults": {
        "atrStop":     { "params": { "atrLength": 14, "mult": 2.1 } },
        "trailingTP":  { "params": { "trailPct": 0.7, "activationR": 1.0 } },
        "breakeven":   { "params": { "activationR": 1.0 } },
        "timeStop":    { "params": { "bars": 30 } }
      },
      "badges": ["Trend", "Pullback"]
    },
    {
      "id": "rsi_momentum_stack",
      "label": "RSI Momentum Stack",
      "blurb": "Sustained momentum regime: RSI holds >50 then pushes above 60.",
      "indicators": ["rsi", "ema", "atr"],
      "seedParams": {
        "rsi": { "length": 14 },
        "ema": { "period": 200 },
        "atr": { "length": 14 }
      },
      "rules": {
        "joiner": "AND",
        "rules": [
          { "left": "close", "op": ">", "right": "ema.value", "optional": true },
          { "left": "rsi.value", "op": ">", "right": 50, "lookback": 5, "mode": "consecutive" },
          { "left": "rsi.value", "op": ">", "right": 60 },
          { "left": "rsi.value", "op": "rising", "right": null, "optional": true }
        ]
      },
      "riskDefaults": {
        "atrStop":     { "params": { "atrLength": 14, "mult": 2.0 } },
        "trailingTP":  { "params": { "trailPct": 0.6, "activationR": 1.0 } },
        "breakeven":   { "params": { "activationR": 1.0 } }
      },
      "badges": ["Momentum", "Regime"]
    }
  ],

  "deprecated": false
}
